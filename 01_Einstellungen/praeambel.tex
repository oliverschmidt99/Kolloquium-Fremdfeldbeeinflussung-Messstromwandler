% --- Dateiname: 01_Einstellungen/praeambel.tex ---
% Beschreibung: Lädt alle benötigten Pakete und definiert die Logik für Notizen (Keynote/Time).

% 1. Basis & Sprache
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}
\usepackage{pgfpages}            % Wichtig für Notizen

% 2. Mathe & Einheiten
\usepackage{amsmath}
\usepackage{siunitx}
\sisetup{locale = DE, range-units = single, list-units = single}
\usefonttheme[onlymath]{serif}

% 3. Grafik & Darstellung
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage[export]{adjustbox}   % Für valign=c
\usepackage{svg}
\usepackage{booktabs}
\usepackage{ragged2e}

% 4. Sonstiges
\usepackage{csquotes}
\usepackage{xurl}
\usepackage{hyperref}
\usepackage{listings}
\lstset{breaklines=true, breakatwhitespace=true, columns=fullflexible}

% --- Notiz-Konfiguration ---
\setbeameroption{show notes on second screen=right}

% Farben für Notizen
\definecolor{MyPastelBackground}{RGB}{225, 250, 225} 
\definecolor{MySeparator}{RGB}{0, 0, 0}
\definecolor{CrimsonRed}{RGB}{220, 20, 60}

% Variablen für Zeit & Keynote
\gdef\insertkeynote{}
\gdef\inserttimestart{--:--}
\gdef\inserttimeend{--:--}

\newcommand{\keynote}[1]{\gdef\insertkeynote{#1}}
\newcommand{\slidetime}[2]{\gdef\inserttimestart{#1}\gdef\inserttimeend{#2}}

% Reset nach jeder Seite
\addtobeamertemplate{note page}{}{
   \gdef\insertkeynote{}
   \gdef\inserttimestart{--:--}
   \gdef\inserttimeend{--:--}
}

% Template für die Notizseite
\setbeamertemplate{note page}{
  \insertvrule{\paperheight}{MyPastelBackground}%
  \vskip-\paperheight%
  \nointerlineskip%
  \vbox to \paperheight{%
    \hbox to \paperwidth{%
      % Links: Keynote
      \begin{minipage}[t][0.45\paperheight]{0.65\paperwidth}
        \vspace{0.5em}\centering
        \textbf{\large \color{CrimsonRed} Wichtig / Note 1}\par\vspace{0.5em}
        \begin{minipage}[t]{0.6\paperwidth}
          \adjustbox{max width=\linewidth, max height=0.30\paperheight}{%
            \parbox[t]{\linewidth}{\RaggedRight\normalfont\small\insertkeynote}
          }
        \end{minipage}
      \end{minipage}%
      \textcolor{MySeparator}{\vrule width 1.5pt}%
      % Rechts: Zeit
      \begin{minipage}[t][0.45\paperheight]{0.33\paperwidth}
        \vspace{1em}\centering\textbf{\large Zeitplanung}\par\vspace{1em}
        \Huge \textbf{\inserttimestart} \\[0.2em] \large \color{gray} bis \\[0.2em] \Huge \textbf{\inserttimeend}
      \end{minipage}%
    }%
    \nointerlineskip
    \textcolor{MySeparator}{\hrule height 1.5pt}%
    \nointerlineskip
    % Unten: Normale Notizen
    \begin{minipage}[t][0.54\textwidth]{\textwidth}
      \vspace{1em}\centering
      \begin{minipage}[t]{0.99\textwidth}
        \adjustbox{max height=0.50\textwidth, max width=\textwidth}{%
          \parbox[t]{\linewidth}{\RaggedRight\sloppy\small\insertnote}
        }
      \end{minipage}
    \end{minipage}
  }%
}